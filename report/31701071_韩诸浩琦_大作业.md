# 2019-2020学年第一学期

## 实验报告

![](zucc.png)

- 课程名称：编译原理
- 实验项目：MicroC编译器（大作业）
- 专业班级：<u>计算机1703</u>
- 学生学号：<u>31701071</u>
- 学生姓名：<u>韩诸浩琦</u>
- 指导老师：<u>郭鸣</u>

## GitHub链接

[github:hzhq1255/microcCompiler](https://github.com/hzhq1255/microcCompiler)

## 增加的功能

- 前缀自增自减
- 算术赋值运算
- for循环
- switch case
- 三目运算

## 测试程序

#### TestPre.c

![image-20200103231849607](31701071_%E9%9F%A9%E8%AF%B8%E6%B5%A9%E7%90%A6_%E5%A4%A7%E4%BD%9C%E4%B8%9A.assets/image-20200103231849607.png)

##### 解释执行

![image-20200103232338099](31701071_%E9%9F%A9%E8%AF%B8%E6%B5%A9%E7%90%A6_%E5%A4%A7%E4%BD%9C%E4%B8%9A.assets/image-20200103232338099.png)

##### 编译运行

![image-20200103234548092](31701071_%E9%9F%A9%E8%AF%B8%E6%B5%A9%E7%90%A6_%E5%A4%A7%E4%BD%9C%E4%B8%9A.assets/image-20200103234548092.png)

![image-20200103234630139](31701071_%E9%9F%A9%E8%AF%B8%E6%B5%A9%E7%90%A6_%E5%A4%A7%E4%BD%9C%E4%B8%9A.assets/image-20200103234630139.png)

--------------------------------------------------------------------------------------------------------------------------------

#### TestPreAssign.c

![image-20200103234045176](31701071_%E9%9F%A9%E8%AF%B8%E6%B5%A9%E7%90%A6_%E5%A4%A7%E4%BD%9C%E4%B8%9A.assets/image-20200103234045176.png)

##### 解释执行

![image-20200103233953284](31701071_%E9%9F%A9%E8%AF%B8%E6%B5%A9%E7%90%A6_%E5%A4%A7%E4%BD%9C%E4%B8%9A.assets/image-20200103233953284.png)

##### 编译运行

![image-20200103234715196](31701071_%E9%9F%A9%E8%AF%B8%E6%B5%A9%E7%90%A6_%E5%A4%A7%E4%BD%9C%E4%B8%9A.assets/image-20200103234715196.png)

![image-20200103234735130](31701071_%E9%9F%A9%E8%AF%B8%E6%B5%A9%E7%90%A6_%E5%A4%A7%E4%BD%9C%E4%B8%9A.assets/image-20200103234735130.png)

--------------------------------------------------------------------------------------------------------------------------------

#### TestFor.c

![image-20200103231943403](31701071_%E9%9F%A9%E8%AF%B8%E6%B5%A9%E7%90%A6_%E5%A4%A7%E4%BD%9C%E4%B8%9A.assets/image-20200103231943403.png)

##### 解释执行

![image-20200103234211855](31701071_%E9%9F%A9%E8%AF%B8%E6%B5%A9%E7%90%A6_%E5%A4%A7%E4%BD%9C%E4%B8%9A.assets/image-20200103234211855.png)

##### 编译运行

![](31701071_%E9%9F%A9%E8%AF%B8%E6%B5%A9%E7%90%A6_%E5%A4%A7%E4%BD%9C%E4%B8%9A.assets/image-20200103234815031.png)

![image-20200103234909259](31701071_%E9%9F%A9%E8%AF%B8%E6%B5%A9%E7%90%A6_%E5%A4%A7%E4%BD%9C%E4%B8%9A.assets/image-20200103234909259.png)

--------------------------------------------------------------------------------------------------------------------------------

#### TestSwitch.c

![image-20200103232010079](31701071_%E9%9F%A9%E8%AF%B8%E6%B5%A9%E7%90%A6_%E5%A4%A7%E4%BD%9C%E4%B8%9A.assets/image-20200103232010079.png)

##### 解释执行

![image-20200103234238639](31701071_%E9%9F%A9%E8%AF%B8%E6%B5%A9%E7%90%A6_%E5%A4%A7%E4%BD%9C%E4%B8%9A.assets/image-20200103234238639.png)

##### 编译运行

![image-20200103235159415](31701071_%E9%9F%A9%E8%AF%B8%E6%B5%A9%E7%90%A6_%E5%A4%A7%E4%BD%9C%E4%B8%9A.assets/image-20200103235159415.png)



![image-20200103235122586](31701071_%E9%9F%A9%E8%AF%B8%E6%B5%A9%E7%90%A6_%E5%A4%A7%E4%BD%9C%E4%B8%9A.assets/image-20200103235122586.png)

--------------------------------------------------------------------------------------------------------------------------------

#### TestSammu.c

##### ![image-20200103232123106](31701071_%E9%9F%A9%E8%AF%B8%E6%B5%A9%E7%90%A6_%E5%A4%A7%E4%BD%9C%E4%B8%9A.assets/image-20200103232123106.png)

##### 解释执行

![image-20200103234319794](31701071_%E9%9F%A9%E8%AF%B8%E6%B5%A9%E7%90%A6_%E5%A4%A7%E4%BD%9C%E4%B8%9A.assets/image-20200103234319794.png)

##### 编译运行

![image-20200103235238480](31701071_%E9%9F%A9%E8%AF%B8%E6%B5%A9%E7%90%A6_%E5%A4%A7%E4%BD%9C%E4%B8%9A.assets/image-20200103235238480.png)

![image-20200103235300729](31701071_%E9%9F%A9%E8%AF%B8%E6%B5%A9%E7%90%A6_%E5%A4%A7%E4%BD%9C%E4%B8%9A.assets/image-20200103235300729.png)

--------------------------------------------------------------------------------------------------------------------------------

## 自我评价

在本次大作业中，能力有限，我只是对microc的语法部分进行了改变。增加了自增、算术赋值、for循环、switch语句以及三目运算等功能。我实现的功能都只能算是基础，只能针对语法、词法这些简单的进行修改。自己也尝试着希望增加些高级功能，比如lambda演算、llvm等，但是还是没有什么进展。按照我现在的改进，我想也只有勉勉强强可以及格的水平。

## 心得体会

一开始学习编译原理的时候，前期的内容比较简单让我还能够听听课就能理解完成实验内容，但是随着课程的深入，内容越来越难以理解，都需要在课后花费大量的时间去查看资料，不断加深理解。左递归、右递归、栈式虚拟机、类型检查推导、F#和Ocaml的语法等等都需要在课后花费大量的时间去学习，去实践，才能完全理解。然而因为这学期其他课程大作业的挤压，再加上前期的不重视导致我最后开始大作业的时候，所留下的时间并不多，知识体系也不完备，只能靠试错来完成功能的增加。不过随着不断的试错，也让我对microc和编译原理加深了理解。

- 我们所需要编译的microc是小型的C语言，microc也是一种命令式语言，而命令式语言主要由表达式和语句构成。老师给我们的microc源码是用F#写的，用到了F#的两个模块，fslex词法扫描和fsyacc语法分析，通过这两个模块生成我们的词法扫描器和语法分析器。
- 而且通过这次大作业我也对yacc的语法有了进一步的理解，yacc包括三部分，定义，规则，程序段这三部分，还了解到了%left，%right，%nonassoc这些操作符怎么来完成优先级的高低。
- 了解到C语言是如何使用存储模型，来修改内存中变量的值，通过变量名的映射到整数，再将存储看成是运行时的上下文环境。知道了求值表达式 eval expr 和 执行语句 exec stmt之间的区别对store内容的影响
- 再者通过这次的大作业也彻底实践了一次语言编译解释的过程。



